@import './variables.less';
@import './themes/@{ethan-theme}.less';

@menu-prefix: ~'@{ethan-prefix}-menu';
@expand-width: 40px;

.@{menu-prefix} {
    position: relative;
    z-index: @zindex-navbar;
    height: 100%;
    padding: 0;
    margin: 0;
    background: @menu-bg;
    line-height: 0; // Fix display inline-block gap
    list-style: none;
    outline: none;

    &-submenu {
        position: relative;

        .@{menu-prefix}-item {
            display: block;
        }

        .@{menu-prefix}-title {
            padding-right: @expand-width;
        }
    }

    &-hidden {
        display: none;
    }

    &-enter {
        transform-origin: left top;

        @keyframes submenu-enter {
            from {
                opacity: 0;
                transform: scale(0.9, 0.9);
            }

            to {
                opacity: 1;
                transform: scale(1, 1);
            }
        }

        animation: submenu-enter 0.25s forwards cubic-bezier(0.08, 0.82, 0.17, 1);
    }

    &-leave {
        transform-origin: left top;

        @keyframes submenu-leave {
            from {
                opacity: 1;
                transform: scale(1, 1);
            }

            to {
                opacity: 0;
                transform: scale(0.9, 0.9);
            }
        }

        animation: submenu-leave 0.25s forwards cubic-bezier(0.6, 0.04, 0.98, 0.34);
    }

    &-expand {
        position: absolute;
        cursor: pointer;
        transition: all 0.2s;
        right: 0;
        top: 0;
        bottom: 0;
        width: @expand-width;
        .caret(down);

        &::after {
            position: absolute;
            top: 50%;
            right: 16px;
            // transform-origin: @menu-title-transform-origin;
            transform: @menu-title-transform;
        }
    }

    &-absolute {
        position: absolute;

        ul {
            padding: 0;
            margin: 0;
            list-style: none;
        }

        > .@{menu-prefix}-list {
            position: absolute;
            width: auto;
            height: auto;
            min-width: auto;
            margin-left: 4px;
            background: @menu-bg;
            border-radius: 4px;
            box-shadow: @menu-box-shadow-base;
            z-index: 1000;
        }
    }

    ul {
        padding: 0;
        margin: 0;
        list-style: none;
    }

    &-item {
        span,
        a {
            display: block;
            color: @menu-item-color;
            white-space: nowrap;
            cursor: pointer;
        }

        a {
            &:focus {
                text-decoration: none;
            }

            &:hover {
                color: @menu-item-light-hover-color;
            }
        }

        span {
            &:hover {
                color: @menu-item-light-hover-color;
                background-color: @menu-item-light-hover-bgc;

                .@{menu-prefix}-expand {
                    .caretColor(@menu-item-light-hover-color);
                }
            }
        }

        &.@{menu-prefix}-disabled a,
        &.@{menu-prefix}-disabled span {
            color: @menu-disabled-color;
            cursor: not-allowed;

            &:hover {
                background: none;
            }

            .@{menu-prefix}-expand {
                .caretColor(@menu-disabled-color);
            }
        }
    }

    &-group {
        color: #999;
        line-height: 1.5;

        &-title {
            padding: 8px 10px;
        }
    }

    &-title {
        transition: all 0.15s ease-in-out;
        position: relative;
        height: @menu-item-height;
        padding: 0 20px;
        line-height: @menu-item-height;
        font-size: @menu-item-font-size;
        overflow: hidden;
        text-overflow: ellipsis;
    }

    &&-inline {
        border-right: solid 1px @menu-border-color;
    }

    .@{menu-prefix}-active {
        padding: @menu-active-padding-vertical @menu-active-padding-horizontal;

        > span {
            background: @menu-item-active-bg;
            color: @menu-item-active-color;
            border-radius: @menu-active-border-radius;
            text-indent: @menu-active-padding-horizontal-negative;

            &::after {
                position: absolute;
                top: 0;
                right: 0;
                width: 3px;
                height: 100%;
                background: @menu-item-active-indicator;
                content: ' ';
            }
        }
    }

    &-horizontal {
        .@{menu-prefix}-wrapper {
            overflow: hidden;
            width: 100%;
            border-bottom: solid 1px @menu-border-color;
        }

        .@{menu-prefix}-item {
            position: relative;
            display: inline-block;
        }

        & > .@{menu-prefix}-active > span {
            position: relative;
            color: @menu-item-active-indicator;

            &::before {
                position: absolute;
                right: 0;
                bottom: -1px;
                left: 0;
                height: 2px;
                background: @menu-item-active-indicator;
                content: ' ';
            }
        }

        .@{menu-prefix}-active.@{menu-prefix}-no-children > span {
            &::after {
                width: 0;
            }
        }
    }

    &-inline {
        &:hover .@{menu-prefix}-bar {
            opacity: 1;
        }

        .@{menu-prefix}-wrapper {
            overflow: hidden;
            height: 100%;
        }

        & > .@{menu-prefix}-item {
            display: block;
        }
    }

    &-inline,
    &-horizontal {
        .@{menu-prefix}-in-path.@{menu-prefix}-submenu > span {
            color: @colors-primary;

            .@{menu-prefix}-expand {
                .caretColor(@colors-primary);
            }
        }
    }

    &-vertical {
        & > .@{menu-prefix}-item {
            position: relative;
        }

        .@{menu-prefix}-wrapper {
            overflow: hidden;
            height: 100%;
        }

        &.@{menu-prefix}-has-open .@{menu-prefix}-wrapper {
            width: 100vw;
        }

        .@{menu-prefix}-in-path.@{menu-prefix}-submenu > span {
            background: @menu-item-active-bg;
            color: @menu-item-active-color;

            .@{menu-prefix}-expand {
                .caretColor(@menu-item-active-color);
            }
        }

        .@{menu-prefix}-active > span {
            background: @menu-item-active-bg;
            color: @menu-item-active-color;
        }

        .@{menu-prefix}-expand {
            &::after {
                transform: @menu-title-vertical-transform;
            }
        }
    }

    &-dark {
        &,
        .@{menu-prefix}-list {
            background-color: @menu-dark-bg;
            color: @menu-dark-item;
        }

        .@{menu-prefix}-item {
            span {
                color: @menu-dark-item;

                &:hover {
                    color: @menu-item-dark-hover-color;
                    background-color: @menu-item-dark-hover-bgc;
                }
            }

            &.@{menu-prefix}-disabled a,
            &.@{menu-prefix}-disabled span {
                &:hover {
                    color: @menu-dark-item;
                    background: none;
                }
            }
        }

        &.@{menu-prefix}-horizontal,
        &.@{menu-prefix}-vertical {
            border-color: @menu-dark-bg;

            .@{menu-prefix}-list {
                background-color: @menu-dark-bg;
                color: @menu-dark-item;
            }
        }

        &.@{menu-prefix}-inline,
        &.@{menu-prefix}-vertical,
        &.@{menu-prefix}-horizontal {
            .@{menu-prefix}-active.@{menu-prefix}-no-children span {
                background: @menu-dark-active-bg;
                color: @menu-dark-active-color;

                &::after,
                &after::before {
                    width: 0;
                    height: 0;
                }
            }

            .@{menu-prefix}-active > span {
                color: @menu-dark-active-color;
            }
        }

        .@{menu-prefix}-submenu-title:hover {
            color: @menu-bg;

            > span {
                color: @menu-bg;
            }
        }
    }
}
